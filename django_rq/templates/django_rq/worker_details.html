{% extends "admin/base_site.html" %}

{% load static django_rq %}

{% block extrastyle %}
    {{ block.super }}
    <style>
        .data {
            display: inline-block;
            float: left;
            width: 80%;
            font-size: 12px;
            padding-top: 3px;
        }
    </style>
    <link href="{% static 'admin/css/forms.css' %}" type="text/css" rel="stylesheet">
{% endblock %}

{% block breadcrumbs %}
    <div class="breadcrumbs">
        <a href="{% url 'admin:index' %}">Home</a> &rsaquo;
        <a href="{% url 'rq_home' %}">Django RQ</a> &rsaquo;
        <a href = "{% url 'rq_workers' queue_index %}">{{ queue.name }} Workers</a> &rsaquo;
        <a href = "{% url 'rq_worker_details' queue_index worker.name %}">{{ worker.name }}</a>
    </div>
{% endblock %}

{% block content_title %}<h1>Worker Info</h1>{% endblock %}

{% block content %}

<div id="content-main">

    <fieldset class="module aligned ">

        <div class="form-row">
            <div>
                <div class = "flex-container">
                    <label>Name:</label>
                    <div class="readonly">{{ worker.name }}</div>
                </div>
            </div>
        </div>

        <div class="form-row">
            <div>
                <div class = "flex-container">
                    <label>State:</label>
                    <div class="readonly">{{ worker.get_state }}</div>
                </div>
            </div>
        </div>

        <div class="form-row">
            <div>
                <div class = "flex-container">
                    <label>Birth:</label>
                    <div class="readonly">{{ worker.birth_date|to_localtime|date:"Y-m-d, H:i:s" }}</div>
                </div>
            </div>
        </div>

        <div class="form-row">
            <div>
                <div class = "flex-container">
                    <label>Queues:</label>
                    <div class="readonly">{{ queue_names }}</div>
                </div>
            </div>
        </div>

        <div class="form-row">
            <div>
                <div class = "flex-container">
                <label>PID:</label>
                <div class="readonly">{{ worker.pid }}</div>
                </div>
            </div>
        </div>

        {% if job %}
        <div class="form-row">
            <div>
                <div class = "flex-container"></div>
                <label>Current Job:</label>
                <div class="readonly">
                    {{ job.func_name }}
                    (<a href = "{% url 'rq_job_detail' queue_index job.id %}">{{ job.id }}</a>)
                </div>
                </div>
            </div>
        </div>

        {% endif %}

        {% if worker.successful_job_count != None %}
            <div class="form-row">
                <div>
                    <div class = "flex-container">
                        <label>Successful job count:</label>
                        <div class="readonly">{{ worker.successful_job_count }}</div>
                    </div>
                </div>
            </div>
        {% endif %}

        {% if worker.failed_job_count != None %}
            <div class="form-row">
                <div>
                    <div class = "flex-container">
                        <label>Failed job count:</label>
                        <div class="readonly">{{ worker.failed_job_count }}</div>
                    </div>
                </div>
            </div>
        {% endif %}

        {% if worker.total_working_time != None %}
            <div class="form-row">
                <div>
                    <div class = "flex-container">
                        <label>Total working time (seconds):</label>
                        <div class="readonly">{{ total_working_time }}</div>
                    </div>
                </div>
            </div>
        {% endif %}

    </fieldset>

</div>

{% endblock %}
